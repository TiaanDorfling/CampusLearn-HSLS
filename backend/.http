################################################################################
# CampusLearn API Test Suite (.http)
# Run with VSCode REST Client / Thunder Client / Postman
# Backend must be running: http://localhost:5000
################################################################################

@baseUrl = http://localhost:5000
@token = jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2ZkYjU4ZDY1Mjg3OGQ5Mjg4NzciLCJyb2xlIjoic3R1ZGVudCIsImlhdCI6MTc2MDgxMzg3MCwiZXhwIjoxNzYwODE3NDcwfQ.wL69nR0t0vsYLoUm_7_pQkMYoSeGZAX0lnkg33BjQ2c

################################################################################
# 1️⃣ AUTHENTICATION
################################################################################

### Register user (Student)
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "name": "Test Student",
  "email": "student1@student.belgiumcampus.ac.za",
  "password": "StrongPass123!",
  "role": "student"
}

### Register user (Tutor)
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "name": "Tutor Example",
  "email": "tutor1@student.belgiumcampus.ac.za",
  "password": "StrongPass123!",
  "role": "tutor"
}

### Login (Student)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "tutor1@student.belgiumcampus.ac.za",
  "password": "StrongPass123!"
}

### Check Session
GET {{baseUrl}}/api/auth/session
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

### Logout
POST {{baseUrl}}/api/auth/logout
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs


################################################################################
# 2️⃣ USER PROFILE
################################################################################

### Get My Student Profile
GET {{baseUrl}}/api/student/me
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

### Update My Profile
PUT {{baseUrl}}/api/student/me
Content-Type: application/json
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

{
  "phone": "0812345678",
  "year": "3",
  "about": "Passionate software engineering student",
  "emergencyContact": {
    "name": "John Doe",
    "phone": "0823456789"
  }
}


################################################################################
# 3️⃣ FORUM MODULE
################################################################################

### Create Category (Admin or Tutor)
POST {{baseUrl}}/api/forum/categories
Content-Type: application/json
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

{
  "name": "PRG381 – Programming",
  "description": "Discussion for programming topics"
}

### List Categories
GET {{baseUrl}}/api/forum/categories
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

### Create Thread in Category
POST {{baseUrl}}/api/forum/threads
Content-Type: application/json
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

{
  "categoryId": "68f3e59b342e22f2dcadc347",
  "title": "Help understanding layered architecture pattern"
}

### List Threads
GET {{baseUrl}}/api/forum/threads?category=68f3e59b342e22f2dcadc347
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

### Create Post in Thread
POST {{baseUrl}}/api/forum/posts
Content-Type: application/json
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

{
  "threadId": "68f3e5ba342e22f2dcadc34a",
  "content": "Layered architecture separates concerns by dividing application logic into distinct layers."
}

### Upvote or React (if implemented)
POST {{baseUrl}}/api/forum/posts/upvote
Content-Type: application/json
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

{
  "postId": "68f3e6b9b54cf49457384a28"
}


################################################################################
# 4️⃣ PRIVATE MESSAGING
################################################################################

### Create Conversation (Student + Tutor)
POST {{baseUrl}}/api/messages/conversations
Content-Type: application/json
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

{
  "participants": [
    { "user": "REPLACE_STUDENT_ID", "role": "student" },
    { "user": "REPLACE_TUTOR_ID", "role": "tutor" }
  ]
}

### List My Conversations
GET {{baseUrl}}/api/messages/conversations
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

### Send Message
POST {{baseUrl}}/api/messages
Content-Type: application/json
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

{
  "conversationId": "REPLACE_WITH_CONVERSATION_ID",
  "text": "Hello! Can you assist with SEN381 project structure?"
}

### Get Messages in Conversation
GET {{baseUrl}}/api/messages?conversationId=REPLACE_WITH_CONVERSATION_ID
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

### Mark Message as Read
PUT {{baseUrl}}/api/messages/read
Content-Type: application/json
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

{
  "messageId": "REPLACE_WITH_MESSAGE_ID"
}


################################################################################
# 5️⃣ TOPICS & RESOURCES
################################################################################

### Upload Resource (requires existing Topic)
POST {{baseUrl}}/api/topics/REPLACE_TOPIC_ID/resource
Content-Type: multipart/form-data; boundary=---------------------------735323031399963166993862150
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MTQ1OTEsImV4cCI6MTc2MDgxODE5MX0.YlIlyaJGZOGH2z42syFwrW_VC_EwJUq9cBvSz3YNPSs

-----------------------------735323031399963166993862150
Content-Disposition: form-data; name="resourceFile"; filename="notes.pdf"
Content-Type: application/pdf

< /path/to/notes.pdf >
-----------------------------735323031399963166993862150--


################################################################################
# 6️⃣ AI CHATBOT (Gemini)
################################################################################

POST {{baseUrl}}/api/ai/chat
Content-Type: application/json

{
  "message": "Explain the difference between synchronous and asynchronous JavaScript"
}

################################################################################
# END OF SUITE
################################################################################
