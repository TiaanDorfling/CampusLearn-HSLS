################################################################################
# CAMPUSLEARN FULL BACKEND TEST SUITE (.http)
# Backend: http://localhost:5000
################################################################################

@baseUrl = http://localhost:5000
@jwt = jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2ZkYjU4ZDY1Mjg3OGQ5Mjg4NzciLCJyb2xlIjoic3R1ZGVudCIsImlhdCI6MTc2MDgxNzY0NCwiZXhwIjoxNzYwODIxMjQ0fQ.aGrd5XBbBvqxsKaunvMr2YruhY94FOwS4JEPIjpSueU


################################################################################
# 1️⃣ AUTHENTICATION
################################################################################

### Register Student
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "name": "Test Student",
  "email": "student1@student.belgiumcampus.ac.za",
  "password": "StrongPass123!",
  "role": "student"
}

### Register Tutor
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "name": "Tutor Example",
  "email": "tutor1@student.belgiumcampus.ac.za",
  "password": "StrongPass123!",
  "role": "tutor"
}

### Login (Student)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "student1@student.belgiumcampus.ac.za",
  "password": "StrongPass123!"
}

### Login (Tutor)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "tutor1@student.belgiumcampus.ac.za",
  "password": "StrongPass123!"
}

### Get Active Session
GET {{baseUrl}}/api/auth/session
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

### Logout
POST {{baseUrl}}/api/auth/logout
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8


################################################################################
# 2️⃣ STUDENT PROFILE
################################################################################

### Get My Student Profile
GET {{baseUrl}}/api/student/me
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

### Update My Student Profile
PUT {{baseUrl}}/api/student/me
Content-Type: application/json
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

{
  "phone": "0812345678",
  "year": "3",
  "about": "Passionate software engineering student at Belgium Campus",
  "emergencyContact": {
    "name": "John Doe",
    "phone": "0823456789"
  },
  "courses": [
    { "code": "SEN381", "name": "Software Engineering" },
    { "code": "DBS200", "name": "Database Systems" }
  ]
}


################################################################################
# 3️⃣ TUTOR PROFILE
################################################################################

### Get My Tutor Profile
GET {{baseUrl}}/api/tutor/me
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

### Update My Tutor Profile
PUT {{baseUrl}}/api/tutor/me
Content-Type: application/json
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

{
  "bio": "Tutor for SEN381 and DBS200, passionate about helping students succeed.",
  "phone": "0835556666",
  "assignedModules": ["SEN381", "DBS200"],
  "tutorTopics": ["Software Architecture", "Database Design"],
  "uploadedResources": [
    { "title": "Design Patterns Lecture Notes", "resourceID": "652f6d000000000000000000" }
  ]
}


################################################################################
# 4️⃣ TOPICS MODULE (Updated)
################################################################################

### Create a New Topic
POST {{baseUrl}}/api/topics
Content-Type: application/json
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

{
  "title": "SEN381 – Software Architecture",
  "description": "Discussion and help for software engineering patterns.",
  "moduleCode": "SEN381"
}

### List All Topics
GET {{baseUrl}}/api/topics
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

### Subscribe to a Topic (Student)
# Replace with real topic _id from "List All Topics"
POST {{baseUrl}}/api/topics/68f401516e1bb3dd5e43cd3a/subscribe
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

### Unsubscribe from a Topic
DELETE {{baseUrl}}/api/topics/68f401516e1bb3dd5e43cd3a/unsubscribe
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

### Broadcast a Tutor Message
POST {{baseUrl}}/api/topics/68f401516e1bb3dd5e43cd3a/broadcast
Content-Type: application/json
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

{
  "message": "Reminder: Submit your SEN381 project proposal by Friday."
}

### Upload Resource to Topic
POST {{baseUrl}}/api/topics/68f401516e1bb3dd5e43cd3a/resource
Content-Type: multipart/form-data; boundary=---------------------------735323031399963166993862150
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

-----------------------------735323031399963166993862150
Content-Disposition: form-data; name="resourceFile"; filename="notes.pdf"
Content-Type: application/pdf

< backend\uploads\Notes.pdf >
-----------------------------735323031399963166993862150--

### List Uploaded Topic Resources
GET {{baseUrl}}/api/topics/68f401516e1bb3dd5e43cd3a/resources
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8


################################################################################
# 5️⃣ FORUM MODULE
################################################################################

### Create Forum Category
POST {{baseUrl}}/api/forum/categories
Content-Type: application/json
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

{
  "name": "SEN381 – Software Engineering",
  "description": "Discussion space for software architecture, testing, and design."
}

### Get All Forum Categories
GET {{baseUrl}}/api/forum/categories
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

### Create Forum Thread
POST {{baseUrl}}/api/forum/threads
Content-Type: application/json
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

{
  "categoryId": "REPLACE_CATEGORY_ID",
  "title": "Understanding Layered Architecture Pattern"
}

### Get Threads in Category
GET {{baseUrl}}/api/forum/threads?category=REPLACE_CATEGORY_ID
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

### Create Forum Post
POST {{baseUrl}}/api/forum/posts
Content-Type: application/json
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

{
  "threadId": "REPLACE_THREAD_ID",
  "content": "Layered architecture divides the app into presentation, business, and data layers."
}

### Upvote a Post
POST {{baseUrl}}/api/forum/posts/upvote
Content-Type: application/json
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

{
  "postId": "REPLACE_POST_ID"
}


################################################################################
# 6️⃣ PRIVATE MESSAGING
################################################################################

### Create Conversation (Student ↔ Tutor)
POST {{baseUrl}}/api/messages/conversations
Content-Type: application/json
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

{
  "participants": [
    { "user": "68ef7fdb58d652878d928877", "role": "student" },
    { "user": "68ef7cf258d652878d928866", "role": "tutor" }
  ]
}

### List My Conversations
GET {{baseUrl}}/api/messages/conversations
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

### Send Message in Conversation
POST {{baseUrl}}/api/messages/REPLACE_CONVERSATION_ID
Content-Type: application/json
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

{
  "text": "Hello! Could you help me with my SEN381 project structure?"
}

### Get Messages in Conversation
GET {{baseUrl}}/api/messages/REPLACE_CONVERSATION_ID
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

### Mark Message as Read
PUT {{baseUrl}}/api/messages/read
Content-Type: application/json
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

{
  "messageId": "REPLACE_MESSAGE_ID"
}


################################################################################
# 7️⃣ AI CHATBOT (Gemini)
################################################################################

POST {{baseUrl}}/api/ai/chat
Content-Type: application/json
Cookie: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2NmMjU4ZDY1Mjg3OGQ5Mjg4NjYiLCJyb2xlIjoidHV0b3IiLCJpYXQiOjE3NjA4MjE4MDUsImV4cCI6MTc2MDgyNTQwNX0.8zADeER13pILCVyVlSyHFCp7Vieg9R08zn5WJOjvIA8

{
  "message": "Explain microservices vs layered architecture."
}


################################################################################
# ✅ END OF SUITE
################################################################################
