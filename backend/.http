################################################################################
# CampusLearn API Test Suite (.http)
# Backend: http://localhost:5000
################################################################################

@baseUrl = http://localhost:5000
@jwt = jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OGVmN2ZkYjU4ZDY1Mjg3OGQ5Mjg4NzciLCJyb2xlIjoic3R1ZGVudCIsImlhdCI6MTc2MDgxNzY0NCwiZXhwIjoxNzYwODIxMjQ0fQ.aGrd5XBbBvqxsKaunvMr2YruhY94FOwS4JEPIjpSueU


################################################################################
# 1️⃣ AUTHENTICATION
################################################################################

### Register Student
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "name": "Test Student",
  "email": "student1@student.belgiumcampus.ac.za",
  "password": "StrongPass123!",
  "role": "student"
}

### Register Tutor
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "name": "Tutor Example",
  "email": "tutor1@student.belgiumcampus.ac.za",
  "password": "StrongPass123!",
  "role": "tutor"
}

### Login (Student)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "student1@student.belgiumcampus.ac.za",
  "password": "StrongPass123!"
}

### Login (Tutor)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "tutor1@student.belgiumcampus.ac.za",
  "password": "StrongPass123!"
}

### Get Active Session
GET {{baseUrl}}/api/auth/session
Cookie: {{jwt}}

### Logout
POST {{baseUrl}}/api/auth/logout
Cookie: {{jwt}}


################################################################################
# 2️⃣ STUDENT PROFILE
################################################################################

### Get My Student Profile
GET {{baseUrl}}/api/student/me
Cookie: {{jwt}}

### Update My Student Profile
PUT {{baseUrl}}/api/student/me
Content-Type: application/json
Cookie: {{jwt}}

{
  "phone": "0812345678",
  "year": "3",
  "about": "Passionate software engineering student at Belgium Campus",
  "emergencyContact": {
    "name": "John Doe",
    "phone": "0823456789"
  },
  "courses": [
    { "code": "SEN381", "name": "Software Engineering" },
    { "code": "DBS200", "name": "Database Systems" }
  ]
}


################################################################################
# 3️⃣ TUTOR PROFILE
################################################################################

### Get My Tutor Profile
GET {{baseUrl}}/api/tutor/me
Cookie: {{jwt}}

### Update My Tutor Profile
PUT {{baseUrl}}/api/tutor/me
Content-Type: application/json
Cookie: {{jwt}}

{
  "bio": "Tutor for SEN381 and DBS200, passionate about helping students succeed.",
  "phone": "0835556666",
  "assignedModules": ["SEN381", "DBS200"],
  "tutorTopics": ["Software Architecture", "Database Design"],
  "uploadedResources": [
    { "title": "Design Patterns Lecture Notes", "resourceID": "652f6d000000000000000000" }
  ]
}

### List Tutor’s Students
GET {{baseUrl}}/api/tutor/68ef7cf258d652878d928866/students
Cookie: {{jwt}}


################################################################################
# 4️⃣ FORUM MODULE
################################################################################

### Create Forum Category
POST {{baseUrl}}/api/forum/categories
Content-Type: application/json
Cookie: {{jwt}}

{
  "name": "SEN381 – Software Engineering",
  "description": "Discussion space for software architecture, testing, and design."
}

### Get Forum Categories
GET {{baseUrl}}/api/forum/categories
Cookie: {{jwt}}

### Create Forum Thread
POST {{baseUrl}}/api/forum/threads
Content-Type: application/json
Cookie: {{jwt}}

{
  "categoryId": "68f3e59b342e22f2dcadc347",
  "title": "Understanding Layered Architecture Pattern"
}

### Get Threads in Category
GET {{baseUrl}}/api/forum/threads?category=68f3e59b342e22f2dcadc347
Cookie: {{jwt}}

### Create Forum Post
POST {{baseUrl}}/api/forum/posts
Content-Type: application/json
Cookie: {{jwt}}

{
  "threadId": "68f3e5ba342e22f2dcadc34a",
  "content": "Layered architecture divides the application into presentation, business, and data layers."
}


################################################################################
# 5️⃣ PRIVATE MESSAGING
################################################################################

### Create Conversation (Student ↔ Tutor)
POST {{baseUrl}}/api/messages/conversations
Content-Type: application/json
Cookie: {{jwt}}

{
  "participants": [
    { "user": "68ef7fdb58d652878d928877", "role": "student" },
    { "user": "68ef7cf258d652878d928866", "role": "tutor" }
  ]
}

### List My Conversations
GET {{baseUrl}}/api/messages/conversations
Cookie: {{jwt}}

### Send Message
POST {{baseUrl}}/api/messages/68f3f91318dc582d695a0349
Content-Type: application/json
Cookie: {{jwt}}

{
  "text": "Hello! Could you help me with my SEN381 project structure?"
}

### Get Messages in Conversation
GET {{baseUrl}}/api/messages/68f3f91318dc582d695a0349
Cookie: {{jwt}}

### Mark Message as Read
PUT {{baseUrl}}/api/messages/read
Content-Type: application/json
Cookie: {{jwt}}

{
  "messageId": "REPLACE_WITH_MESSAGE_ID"
}


################################################################################
# 6️⃣ TOPICS & RESOURCES
################################################################################

### Upload Resource (for an existing Topic)
POST {{baseUrl}}/api/topics/REPLACE_TOPIC_ID/resource
Content-Type: multipart/form-data; boundary=---------------------------735323031399963166993862150
Cookie: {{jwt}}

-----------------------------735323031399963166993862150
Content-Disposition: form-data; name="resourceFile"; filename="notes.pdf"
Content-Type: application/pdf

< /path/to/notes.pdf >
-----------------------------735323031399963166993862150--


################################################################################
# 7️⃣ AI CHATBOT (Gemini)
################################################################################

POST {{baseUrl}}/api/ai/chat
Content-Type: application/json
Cookie: {{jwt}}

{
  "message": "Explain microservices vs layered architecture."
}


################################################################################
# ✅ END OF SUITE
################################################################################
